# Vuex를 이용한 상태 관리

## 왜 Vuex를 사용하는가?

Vue.js는 MVVM(Model - View - View Model) 패턴이 적용된 프레임워크라는 점은 이미 알고 있습니다. MVVM 패턴에서 **Model 즉, 데이터가 핵심**입니다. 데이터가 변경되면 View Model을 통해서 View가 즉시 변경됩니다.

![](https://t1.daumcdn.net/cfile/tistory/2352BF33586C625E23)

모든 화면(View) 은 데이터(Model) 에 의해 결정되는 구조이기 때문에 개발자는 애플리케이션의 데이터를 체계적으로 구조화하고 관리해야 합니다. 하지만 컴포넌트가 각각데이터를 가지고 있으면 중복이발생하고 대이터 변경도 쉽지 않을것 입니다. 그렇다고 props로 일일이 전달하는 것도 한계가 있고 이벤트 버스 객체를 사용한다 해도 복잡한 계층 구조에서는 문제점이 많습니다. 데이터에 새로운 정보가 추가된다면 props의 옵션을 모두 변경해야하는 문제가 생길수 있습니다.

또 다른 방법을 생각해보면 전역 객체를 만들어서 각 컴포넌트에서 참조하여 사용하는 방법입니다. 하지만 이러한 방법도 문제가 있습니다. 이러한 중요한 데이터가 어느 컴포넌트에서든 변경 가능하면 안되기 때문입니다.

이러한 이유들로 Vuex와 같은 상태 관리 라이브러리를 사용합니다.

- 중앙 집중화된 상태 정보 관리가 필요하다.
- 상태 정보가 변경되는 상황과 시간을 추적하고 싶다.
- 컴포넌트에서 상태 정보를 안전하게 접근하고 싶다.

## Vuex란?

Vuex는 Vue.js 애플리케이션에서 상태 관리 패턴을 지원하는 라이브러리입니다. 애플리케이션 내부의 모든 컴포넌트들이 공유하는 중앙 집중화된 상태 정보 저장소 역할을 하며 상태 변경을 투명하게 할 수 있습니다. 이 데이터는 전역에서 저장소(store) 객체를 통해서 관리합니다.

다음 사진은 Vuex의 아키텍쳐 입니다.
![](https://joshua1988.github.io/images/posts/web/vuejs/vuex-1/vuex-diagram.png)

![](https://joshua1988.github.io/images/posts/web/vuejs/vuex-1/vuex-state-one-way-data-flow.png)

화살표가 한 방향으로만 흘러가듯 해서 `"단방향 데이터 흐름"` 이라는 용어를 씁니다. 전체적인 처리 흐름은 다음과 같습니다.

- 컴포넌트가 액션(Action) 을 일으킵니다(예를 들면 버튼 클릭).
- 액션에서는 외부 API를 호출한 뒤 그 결과를 이용해 변이(Mutation)를 일으킵니다(외부 API가 없다면 생략).
- 변이에서는 액션의 결과를 받아 상태(State)를 변경합니다. 이 단계는 추적할 수 있기 때문에 Vue.js DevTools와 같은 도구를 이용하면 상태 변경의 내역을 모두 확인할 수 있습니다.
- 변이에 의해 변경된 상태는 다시 컴포넌트에 바인딩되어 화면을 갱신합니다.

첫 번째 사진에서 점선으로 표시된 부분이 Vuex 저장소(Store) 객체 영역입니다. 저장소가 상태(State: 데이터), 변이(Mutation), 액션(Action)을 모두 관리합니다. **저장소는 애플리케이션의 상태를 중앙집중화하여 관리하는 컨테이너이며 일반적인 전역 객체와는 달리 저장소의 상태를 직접 변경하지 않습니다. 반드시 변이(mutation)를 통해서만 변경합니다.**

한 가지 주의할 점은 변이의 목적은 **상태의 변경**이라는 점입니다. 상태의 변경과 관련이 없는 작업이 변이 내부에서 수행되지 않도록 해야한다. 또한 변이는 동기적인 작업입니다. 비동기 처리는 변이를 통해서 수행하지 않습니다.

상태 변화와 관련이 없는 작업은 액션(Action)을 정의해서 실행하여 비즈니스 로직이 실행되도록 합니다. 그후 액션의 처리 결과는 변이를 호출할 때 전달하여 상태(state) 를 변경합니다.

전체적인 흐름을 살펴보면 Vue 컴포넌트가 나타내는 UI는 저장소(Store) 의 상태(State)를 반영하고, Vue 컴포넌트의 UI에서 발생하는 행위는 액션(Action) 을 통해 외부 API를 호출합니다. API 실행 결과는 변이를 통해서 다시 상태를 변화시킵니다.

## 상태와 변이

상태(state)와 변이(mutation)는 Vuex 저장소(store) 내부의 핵심 요소입니다. 상태는 애플리케이션에서 관리해야 할 중요한 데이터이며, 변이는 상태를 변경하는 함수들을 보유하고 있는 객체입니다. 전역에서 Vue.use(Vuex) 코드의 실행으로 애플리케이션 내부의 모든 컴포넌트가 저장소의 상태, 변이 객체에 접근할 수 있습니다. 상태는 반드시 변이를 통해서만 변경하도록 해야 합니다.
